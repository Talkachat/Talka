<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Tic-Tac-Toe</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --p1-color: #ff4757; --p2-color: #2e86de; }
        body { font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; background: #1a1a2e; color: white; }
        
        .menu { background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; margin-bottom: 20px; text-align: center; width: 320px; }
        .menu input, .menu select { width: 80%; padding: 8px; margin: 5px 0; border-radius: 5px; border: none; }
        
        .board { display: grid; grid-template-columns: repeat(3, 100px); gap: 10px; margin: 20px; }
        .cell { width: 100px; height: 100px; background: #16213e; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 3rem; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .cell:hover { background: #0f3460; }
        .cell.x { color: var(--p1-color); }
        .cell.o { color: var(--p2-color); }
        .winner-cell { background: #2ed573 !important; color: white !important; }

        .status { font-size: 1.5rem; margin-bottom: 10px; font-weight: bold; }
        .controls button { padding: 10px 20px; cursor: pointer; border-radius: 5px; border: none; background: var(--p1-color); color: white; font-weight: bold; }
    </style>
</head>
<body>

    <h1>üéÆ Tic-Tac-Toe Pro</h1>

    <div class="menu">
        <select id="gameMode" onchange="resetGame()">
            <option value="pvp">Player vs Player (Local)</option>
            <option value="pvc">Player vs Computer (AI)</option>
        </select>
        <input type="text" id="p1Name" placeholder="Player X Name" value="Player 1">
        <input type="text" id="p2Name" placeholder="Player O Name" value="Computer">
    </div>

    <div class="status" id="status">X's Turn</div>

    <div class="board" id="board">
        <div class="cell" data-index="0"></div>
        <div class="cell" data-index="1"></div>
        <div class="cell" data-index="2"></div>
        <div class="cell" data-index="3"></div>
        <div class="cell" data-index="4"></div>
        <div class="cell" data-index="5"></div>
        <div class="cell" data-index="6"></div>
        <div class="cell" data-index="7"></div>
        <div class="cell" data-index="8"></div>
    </div>

    <div class="controls">
        <button onclick="resetGame()">Restart Game</button>
    </div>

    <script>
        const cells = document.querySelectorAll('.cell');
        const statusTxt = document.getElementById('status');
        let board = ["", "", "", "", "", "", "", "", ""];
        let currentPlayer = "X";
        let active = true;

        const winConditions = [
            [0,1,2], [3,4,5], [6,7,8], [0,3,6], [1,4,7], [2,5,8], [0,4,8], [2,4,6]
        ];

        function handleClick(e) {
            const i = e.target.dataset.index;
            if (board[i] !== "" || !active) return;

            makeMove(i, currentPlayer);

            if (active && document.getElementById('gameMode').value === 'pvc' && currentPlayer === "O") {
                setTimeout(computerMove, 500);
            }
        }

        function makeMove(index, player) {
            board[index] = player;
            cells[index].innerText = player;
            cells[index].classList.add(player.toLowerCase());
            checkResult();
        }

        function checkResult() {
            let win = null;
            for (let condition of winConditions) {
                const [a, b, c] = condition;
                if (board[a] && board[a] === board[b] && board[a] === board[c]) {
                    win = condition;
                    break;
                }
            }

            if (win) {
                const winnerName = currentPlayer === "X" ? document.getElementById('p1Name').value : document.getElementById('p2Name').value;
                statusTxt.innerText = `üèÜ ${winnerName} Wins!`;
                active = false;
                win.forEach(i => cells[i].classList.add('winner-cell'));
                confetti();
            } else if (!board.includes("")) {
                statusTxt.innerText = "ü§ù Draw!";
                active = false;
            } else {
                currentPlayer = currentPlayer === "X" ? "O" : "X";
                const nextName = currentPlayer === "X" ? document.getElementById('p1Name').value : document.getElementById('p2Name').value;
                statusTxt.innerText = `${nextName}'s Turn (${currentPlayer})`;
            }
        }

        // --- AI LOGIC (MINIMAX) ---
        function computerMove() {
            let bestScore = -Infinity;
            let move;
            for (let i = 0; i < 9; i++) {
                if (board[i] === "") {
                    board[i] = "O";
                    let score = minimax(board, 0, false);
                    board[i] = "";
                    if (score > bestScore) {
                        bestScore = score;
                        move = i;
                    }
                }
            }
            makeMove(move, "O");
        }

        function minimax(currBoard, depth, isMaximizing) {
            let result = evaluate(currBoard);
            if (result !== null) return result;

            if (isMaximizing) {
                let bestScore = -Infinity;
                for (let i = 0; i < 9; i++) {
                    if (currBoard[i] === "") {
                        currBoard[i] = "O";
                        bestScore = Math.max(bestScore, minimax(currBoard, depth + 1, false));
                        currBoard[i] = "";
                    }
                }
                return bestScore;
            } else {
                let bestScore = Infinity;
                for (let i = 0; i < 9; i++) {
                    if (currBoard[i] === "") {
                        currBoard[i] = "X";
                        bestScore = Math.min(bestScore, minimax(currBoard, depth + 1, true));
                        currBoard[i] = "";
                    }
                }
                return bestScore;
            }
        }

        function evaluate(b) {
            for (let c of winConditions) {
                if (b[c[0]] && b[c[0]] === b[c[1]] && b[c[0]] === b[c[2]]) {
                    return b[c[0]] === "O" ? 10 : -10;
                }
            }
            return b.includes("") ? null : 0;
        }

        function resetGame() {
            board = ["", "", "", "", "", "", "", "", ""];
            currentPlayer = "X";
            active = true;
            statusTxt.innerText = `${document.getElementById('p1Name').value}'s Turn (X)`;
            cells.forEach(c => { c.innerText = ""; c.className = "cell"; });
        }

        cells.forEach(c => c.addEventListener('click', handleClick));
    </script>
</body>
</html>
