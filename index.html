<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Tac-Toe AI Difficulty</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --p1: #ff4757; --p2: #2e86de; --bg: #0f3460; }
        body { font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; align-items: center; min-height: 100vh; background: #1a1a2e; color: white; margin: 0; padding: 20px; }
        
        .setup { background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; text-align: center; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        select, input { padding: 10px; border-radius: 5px; border: none; margin: 5px; font-size: 1rem; }

        .status { font-size: 1.5rem; margin-bottom: 15px; font-weight: bold; color: #e94560; }
        
        .board { display: grid; grid-template-columns: repeat(3, 100px); gap: 12px; }
        .cell { width: 100px; height: 100px; background: #16213e; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 3rem; font-weight: bold; cursor: pointer; transition: 0.2s; border: 2px solid transparent; }
        .cell:hover { background: #1f4068; border-color: #e94560; }
        .cell.x { color: var(--p1); }
        .cell.o { color: var(--p2); }
        .win { background: #2ed573 !important; transform: scale(1.05); }

        button.reset { margin-top: 25px; padding: 12px 30px; border: none; border-radius: 50px; background: #e94560; color: white; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button.reset:hover { background: #ff4757; transform: translateY(-2px); }
    </style>
</head>
<body>

    <h1>ðŸ¤– AI Battle</h1>

    <div class="setup">
        <input type="text" id="userName" placeholder="Your Name" value="Player 1">
        <select id="difficulty">
            <option value="easy">Level: Beginner (Random)</option>
            <option value="medium">Level: Medium (Mixed)</option>
            <option value="hard">Level: Hard (Unbeatable)</option>
        </select>
    </div>

    <div class="status" id="status">Your Turn!</div>

    <div class="board" id="board">
        <div class="cell" data-index="0"></div>
        <div class="cell" data-index="1"></div>
        <div class="cell" data-index="2"></div>
        <div class="cell" data-index="3"></div>
        <div class="cell" data-index="4"></div>
        <div class="cell" data-index="5"></div>
        <div class="cell" data-index="6"></div>
        <div class="cell" data-index="7"></div>
        <div class="cell" data-index="8"></div>
    </div>

    <button class="reset" onclick="resetGame()">Restart Game</button>

    <script>
        const cells = document.querySelectorAll('.cell');
        const statusTxt = document.getElementById('status');
        let board = ["", "", "", "", "", "", "", "", ""];
        let active = true;
        let human = "X";
        let ai = "O";

        const winLines = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];

        function handleClick(e) {
            const idx = e.target.dataset.index;
            if (board[idx] !== "" || !active) return;

            makeMove(idx, human);
            
            if (active) {
                statusTxt.innerText = "Computer is thinking...";
                setTimeout(aiTurn, 600);
            }
        }

        function makeMove(idx, player) {
            board[idx] = player;
            cells[idx].innerText = player;
            cells[idx].classList.add(player.toLowerCase());
            checkWinner(player);
        }

        function aiTurn() {
            if (!active) return;
            const diff = document.getElementById('difficulty').value;
            let move;

            if (diff === 'easy') {
                move = getRandomMove();
            } else if (diff === 'medium') {
                // 50% chance to play perfect, 50% to play random
                move = Math.random() > 0.5 ? getBestMove() : getRandomMove();
            } else {
                move = getBestMove();
            }

            makeMove(move, ai);
            if (active) statusTxt.innerText = "Your Turn!";
        }

        function getRandomMove() {
            let available = board.map((v, i) => v === "" ? i : null).filter(v => v !== null);
            return available[Math.floor(Math.random() * available.length)];
        }

        function getBestMove() {
            let bestScore = -Infinity;
            let move;
            for (let i = 0; i < 9; i++) {
                if (board[i] === "") {
                    board[i] = ai;
                    let score = minimax(board, 0, false);
                    board[i] = "";
                    if (score > bestScore) {
                        bestScore = score;
                        move = i;
                    }
                }
            }
            return move;
        }

        function minimax(tempBoard, depth, isMaxing) {
            let res = evaluate(tempBoard);
            if (res !== null) return res;

            if (isMaxing) {
                let best = -Infinity;
                for (let i = 0; i < 9; i++) {
                    if (tempBoard[i] === "") {
                        tempBoard[i] = ai;
                        best = Math.max(best, minimax(tempBoard, depth + 1, false));
                        tempBoard[i] = "";
                    }
                }
                return best;
            } else {
                let best = Infinity;
                for (let i = 0; i < 9; i++) {
                    if (tempBoard[i] === "") {
                        tempBoard[i] = human;
                        best = Math.min(best, minimax(tempBoard, depth + 1, true));
                        tempBoard[i] = "";
                    }
                }
                return best;
            }
        }

        function evaluate(b) {
            for (let line of winLines) {
                if (b[line[0]] && b[line[0]] === b[line[1]] && b[line[0]] === b[line[2]]) {
                    return b[line[0]] === ai ? 10 : -10;
                }
            }
            return b.includes("") ? null : 0;
        }

        function checkWinner(player) {
            let winner = null;
            for (let line of winLines) {
                if (board[line[0]] && board[line[0]] === board[line[1]] && board[line[0]] === board[line[2]]) {
                    winner = line;
                }
            }

            if (winner) {
                active = false;
                winner.forEach(i => cells[i].classList.add('win'));
                const name = player === "X" ? document.getElementById('userName').value : "Computer";
                statusTxt.innerText = `ðŸ† ${name} Wins!`;
                if (player === "X") confetti();
            } else if (!board.includes("")) {
                active = false;
                statusTxt.innerText = "ðŸ¤ Draw!";
            }
        }

        function resetGame() {
            board = ["", "", "", "", "", "", "", "", ""];
            active = true;
            statusTxt.innerText = "Your Turn!";
            cells.forEach(c => { c.innerText = ""; c.className = "cell"; });
        }

        cells.forEach(c => c.addEventListener('click', handleClick));
    </script>
</body>
</html>
