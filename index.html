<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Tic-Tac-Toe: 3 Levels</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --primary: #00d2ff; --secondary: #3a7bd5; --accent: #ff0058; }
        body { font-family: 'Segoe UI', sans-serif; background: #0f0c29; color: white; display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        
        .panel { background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px; border: 1px solid rgba(255,255,255,0.1); margin-bottom: 20px; text-align: center; width: 320px; }
        select, input { width: 90%; padding: 10px; margin: 8px 0; border-radius: 8px; border: none; background: #1a1a3a; color: white; font-size: 1rem; }
        
        .status { font-size: 1.4rem; margin: 15px 0; font-weight: bold; color: var(--primary); text-shadow: 0 0 10px rgba(0,210,255,0.5); }
        
        .board { display: grid; grid-template-columns: repeat(3, 100px); gap: 12px; }
        .cell { width: 100px; height: 100px; background: rgba(255,255,255,0.03); border: 2px solid rgba(255,255,255,0.1); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 2.8rem; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .cell:hover { background: rgba(255,255,255,0.1); border-color: var(--primary); }
        .cell.x { color: var(--primary); }
        .cell.o { color: var(--accent); }
        .cell.winning-cell { background: #2ed573 !important; color: #fff !important; }

        .btn { margin-top: 25px; padding: 12px 35px; border: none; border-radius: 50px; background: linear-gradient(to right, var(--primary), var(--secondary)); color: white; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn:hover { transform: scale(1.05); box-shadow: 0 0 20px rgba(0,210,255,0.4); }

        .visitor-box { margin-top: 40px; font-size: 0.8rem; color: #888; display: flex; align-items: center; gap: 8px; }
        .dot { width: 8px; height: 8px; background: #2ed573; border-radius: 50%; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0.3; } }
    </style>
</head>
<body>

    <div class="panel">
        <input type="text" id="pName" placeholder="Enter Your Name" value="Player 1">
        <select id="diff">
            <option value="1">Level: Beginner (Random)</option>
            <option value="2">Level: Intermediate (Blocks Moves)</option>
            <option value="3">Level: Hard (Minimax - Unbeatable)</option>
        </select>
    </div>

    <div class="status" id="status">Your Turn!</div>

    <div class="board" id="board">
        <div class="cell" data-index="0"></div>
        <div class="cell" data-index="1"></div>
        <div class="cell" data-index="2"></div>
        <div class="cell" data-index="3"></div>
        <div class="cell" data-index="4"></div>
        <div class="cell" data-index="5"></div>
        <div class="cell" data-index="6"></div>
        <div class="cell" data-index="7"></div>
        <div class="cell" data-index="8"></div>
    </div>

    <button class="btn" onclick="reset()">Restart Match</button>

    <div class="visitor-box">
        <div class="dot"></div> Total Global Visitors: <span id="vCount">0</span>
    </div>

    <script>
        const cells = document.querySelectorAll('.cell');
        const statusTxt = document.getElementById('status');
        let board = ["", "", "", "", "", "", "", "", ""];
        let active = true;
        let hu = "X";
        let ai = "O";

        const wins = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];

        function handleClick(e) {
            const i = e.target.dataset.index;
            if (board[i] !== "" || !active) return;
            makeMove(i, hu);
            if (active) setTimeout(aiPlay, 500);
        }

        function makeMove(i, p) {
            board[i] = p;
            cells[i].innerText = p;
            cells[i].classList.add(p.toLowerCase());
            check(p);
        }

        function aiPlay() {
            const d = document.getElementById('diff').value;
            let move;
            if (d == "1") move = randomMove();
            else if (d == "2") move = midMove();
            else move = bestMove();
            makeMove(move, ai);
        }

        function randomMove() {
            let avail = board.map((v,i) => v===""?i:null).filter(v=>v!==null);
            return avail[Math.floor(Math.random()*avail.length)];
        }

        function midMove() {
            // Check if AI can win or needs to block player
            for(let p of [ai, hu]) {
                for(let line of wins) {
                    let vals = line.map(i => board[i]);
                    if(vals.filter(v => v===p).length === 2 && vals.includes("")) {
                        return line[vals.indexOf("")];
                    }
                }
            }
            return randomMove();
        }

        function bestMove() {
            let bScore = -Infinity, move;
            for(let i=0; i<9; i++) {
                if(board[i]==="") {
                    board[i]=ai;
                    let score = minimax(board, 0, false);
                    board[i]="";
                    if(score > bScore) { bScore = score; move = i; }
                }
            }
            return move;
        }

        function minimax(b, depth, isMax) {
            let res = evalWin(b);
            if(res !== null) return res;
            if(isMax) {
                let best = -Infinity;
                for(let i=0; i<9; i++) if(b[i]==="") {
                    b[i]=ai; best = Math.max(best, minimax(b, depth+1, false)); b[i]="";
                }
                return best;
            } else {
                let best = Infinity;
                for(let i=0; i<9; i++) if(b[i]==="") {
                    b[i]=hu; best = Math.min(best, minimax(b, depth+1, true)); b[i]="";
                }
                return best;
            }
        }

        function evalWin(b) {
            for(let l of wins) if(b[l[0]] && b[l[0]]===b[l[1]] && b[l[0]]===b[l[2]]) return b[l[0]]===ai?10:-10;
            return b.includes("") ? null : 0;
        }

        function check(p) {
            let winLine = wins.find(l => board[l[0]] && board[l[0]]===board[l[1]] && board[l[0]]===board[l[2]]);
            if(winLine) {
                active = false;
                winLine.forEach(i => cells[i].classList.add('winning-cell'));
                statusTxt.innerText = p === hu ? `ðŸ† ${document.getElementById('pName').value} Wins!` : "ðŸ’» Computer Wins!";
                if(p === hu) confetti();
            } else if(!board.includes("")) {
                active = false; statusTxt.innerText = "ðŸ¤ Draw!";
            } else {
                statusTxt.innerText = p === hu ? "Computer is thinking..." : "Your Turn!";
            }
        }

        function reset() {
            board = ["","","","","","","","",""]; active = true;
            statusTxt.innerText = "Your Turn!";
            cells.forEach(c => { c.innerText = ""; c.className = "cell"; });
        }

        cells.forEach(c => c.addEventListener('click', handleClick));

        // Simplified Visitor Counter for Demo
        let count = localStorage.getItem('vCount') || 1240;
        localStorage.setItem('vCount', ++count);
        document.getElementById('vCount').innerText = count;
    </script>
</body>
</html>
